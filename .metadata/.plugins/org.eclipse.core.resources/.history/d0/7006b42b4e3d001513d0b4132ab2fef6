package nl.woupiestek.andrej

import util.parsing.combinator._
//import nl.woupiestek.andrej._

/**
 * @author Wouter
 */
object Parse extends RegexParsers {
  def expression = terminal | application | abstraction | product | cut

  def terminal = universe | variable

  def variable = """^[a-zA-Z]+$"""

  def universe = """^Type\\d$"""

  def application = "(" ~ expression.* ~ ")"

  def abstraction = "(\\" ~ variable ~ "." ~ expression ~ ")"

  def product = "Product ".~(abstraction)

  def cut = "(Let " ~ variable ~ " be " ~ expression ~ ". " ~ expression ~ ")"

  def apply(input: String) = parseAll(expression, input)
}