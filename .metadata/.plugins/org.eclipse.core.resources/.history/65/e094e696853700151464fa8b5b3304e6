package nl.woupiestek.andrej

import scala.util.Try
import scala.util.Success
import scala.util.Failure


/**
 * @author Wouter
 */
object Evaluate {
  
  def apply(expression: Expression):Try[Expression] = {
    expression match {
      case x:Variable => Success(x)
      case Application(t,u) => for(t2 <- apply(t); u2 <- apply(u)) yield {
        t2 match {
          case Abstraction(v,d,t3) => apply(Cut(v,u2,t3))
          case _ => Success[Application(t2,u2)]
        }
      }
      
    }
  }
  
  
}