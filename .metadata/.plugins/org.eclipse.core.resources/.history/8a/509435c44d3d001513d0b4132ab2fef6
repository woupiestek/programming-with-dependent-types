package nl.woupiestek.andrej

import util.parsing.combinator._
//import nl.woupiestek.andrej._

/**
 * @author Wouter
 */
object Parse extends RegexParsers {
  def expression:Parser[String] = terminal | application | abstraction | product | cut

  def terminal:Parser[String] = universe | variable

  def variable:Parser[String] = """^[a-zA-Z]+$"""

  def universe:Parser[String] = """^Type\\d$"""

  def application:Parser[String] = "(" ~ expression.* ~ ")"

  def abstraction:Parser[String] = "(\\" ~ variable ~ "." ~ expression ~ ")"

  def product:Parser[String] = "Product ".~(abstraction)

  def cut:Parser[String] = "(Let " ~ variable ~ " be " ~ expression ~ ". " ~ expression ~ ")"

  def apply(input: String):Parser[String] = parseAll(expression, input)
}